<h1><%= @event.name %> / 日志管理</h1>
<%= form_tag admin_event_registrations_path(@event), :method => :get do %>

 <p>
   <% Registration::STATUS.each do |s| %>
      <label><%= check_box_tag "statuses[]", s, Array(params[:statuses]).include?(s) %> <%= t(s, :scope =>  "registration.status") %> (<%= @event.registrations.by_status(s).size %>)</label>
   <% end %>
  </p>

  <p>
    <% @event.tickets.each do |t| %>
      <label><%= check_box_tag "ticket_ids[]", t.id, Array(params[:ticket_ids]).include?(t.id.to_s) %> <%= t.name %> (<%=  @event.registrations.where( :ticket_id => t.id ).size %>)</label>
    <% end %>
  </p>
  <p>
    日期：<%= date_field_tag :start_on, params[:start_on] %>～<%= date_field_tag :end_on, params[:end_on] %>
  </p>

  <p class="text-right">
    <%= submit_tag "送出筛选", :class => "btn btn-primary" %>
  </p>
<% end %>

<table class="table">
<tr>
  <th>ID</th>
  <th>业务</th>
  <th>操作人</th>
  <th>状态</th>
  <th>建立时间</th>
  <th>操作</th>
</tr>
<% @registrations.each do |registration| %>
  <tr>
    <td><%= registration.id %></td>
    <td><%= registration.ticket.name %></td>
    <td><%= registration.name %></td>
    <td><%= t( registration.status, :scope => "registration.status") %></td>
    <td><%= registration.created_at.strftime("%Y/%m/%d %I:%M %p") %></td>
    <td><%= link_to "Delete", admin_event_registration_path(@event, registration), :method => "delete", :data => { :confirm => "Are you sure?" }, :class => "btn btn-danger" %></td>
  </tr>
<% end %>
</table>
<%= paginate @registrations %>
